---
layout: post
title: exsi-虚拟机安装配置
categories: [cm, vm, exsi]
tags: [vmware, exsi]
---

* 参考： 
  * [csdn.net - jenrey - ESXI 6.5安装详细步骤](https://blog.csdn.net/JENREY/article/details/83750891)
  * []()
  * []()
  * []()
  * []()
  * []()



1. 制作安装U盘
    使用rufus将iso（如，VMware-VMvisor-Installer-6.7.0.update02-13006603.x86_64.iso）刷进u盘。
    使用utltriso，以USB-HDD+的方式可能没用，可能iso文件的启动方式太老，不适合某些BIOS。
1. 安装
    1. 插入U盘启动电脑，启动菜单，选择第一个：`ESXi-...`启动
    1. 按屏幕提示安装，选择安装的硬盘、设置ESXI登陆密码、……完成后重启电脑。
1. 配置ESXI （显示器连Esxi的机器操作）
    F2登陆进入配置界面
    Configure Managment Network 》 Network Adapter 选择网卡/网口
    IPv4 Configuration \> Set static IPv4 Address \> 填写静态的局域网IP
    ~~~
    示例：
    IPv4 Address : 192.168.1.252 Exsi管理地址
    Subnet Mask: 255.255.0.0
    Default Gateway: 192.168.1.1  主路由地址
    ~~~
1. 重启 Restart Management Network

1. --- ---

1. 远程登陆到EXSI管理界面
1. 配置 》硬件 》存储器 》添加存储器，添加后可以访问本地硬盘
1. 双击 对应硬盘的存储器 》数据存储浏览器，可以浏览硬盘内容、上传、下载文件
1. 配置 》网络
    添加wan口： 添加网络。。。 》虚拟机 》创建vSphere标准交换机 》选择没用的网口 》网络标签：wan
    添加lan口： 添加网络。。。 》虚拟机 》创建vSphere标准交换机 》选择没用的网口 》网络标签：lan
1. 导入ovf虚拟机 - ros
    菜单 文件 》部署ovf模板 》选中文件系统ros的ovf模板
1. 选中新建的ros虚拟机，右键菜单 》 编辑设置
    内存：512M，ros最高2G内存
    CPU：2（1个核心-2线程）
    显卡：显存：16M以上
1. 给ros虚拟机添加网卡
    1. 选中新建的ros虚拟机，右键菜单 》 编辑设置 》添加。。。》以太网适配器
    2. 网络连接： 网络标签：lan
    3. 同上述步骤，添加wan虚拟网卡、管理网卡
1. ---
1. 同 上述步骤导入ovf虚拟机 - lede
    给lede虚拟机添加网卡：删除所有网卡，创建lan虚拟网卡
    设置lede的IP地址
1. 
1. 


### 安装过程中，出现“No Network Adopters”提示

是因为下载的ios文件中没有嵌入网卡驱动的原因。如果出现这种情况可以参考 [这篇文章](https://links.jianshu.com/go?to=https%3A%2F%2Fblog.whsir.com%2Fpost-3377.html)。



## 备份


### EXSi 6.7 网页控制台导出小于100M的虚拟机

选中虚拟机 》右键菜单，选择导出， 但是只能导出 **小于100M的虚拟机**


### OVFTool 备份

* 参考
  * [Vedio Talk - ESXI中阶教程 如何备份虚拟机ova模版，一次配置一劳永逸](https://www.vediotalk.com/archives/4297)
  * []()
  * []()
  * []()

能突破100M的限制

* 获取OVFTool的方法：

  1. 已经带有OVFTool的软件：
      * Mac - VMware Fusion
      * Windows - VMware Workstation

  2. 去官网下载

  官网下载地址： <https://my.vmware.com/cn/web/vmware/details?downloadGroup=OVFTOOL430U2&productId=758>


* ovftool 备份
1. 设置到环境变量，mac上是`~/.bash_profile`
1. 导出虚拟机，`ovftool vi://root:@10.10.10.254/LEDE /Users/vee/Desktop/ledeova/lede.ova`
    * 格式：`ovftool vi://root:@ESXI的IP地址/虚拟机的名称  /存放位置/自定一个名称.ova`
1. 注意事项：
    * 如果你的虚拟机配置了直通网卡，或者添加其他PCI设备，需要移除后再备份，不然就会出现如下报错信息： Unknown device: 'PCI device 0'













