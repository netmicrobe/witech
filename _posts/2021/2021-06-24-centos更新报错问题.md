---
layout: post
title: centos更新报错问题.md
categories: [ cm, centos ]
tags: [ yum ]
---

* 参考
  * [CentOS6 yum命令报错YumRepo Error: All mirror URLs are not using ftp, http[s] or file，修改yum源后404 Not Found](https://www.cnblogs.com/pistachio123/p/14301949.html)
  * []()
---

CentOS6 yum 命令报错 `YumRepo Error: All mirror URLs are not using ftp, http[s] or file`，修改yum源后404 Not Found

据说是因为，CentOS6已经在2020年11月30日停止维护了。centos官方停止了对centos6的所有更新，并且下架了包括官方所有的centos6源，目前阿里、163、清华等centos6源已无法使用。

* CentOS 6 停止维护更新日期： 2020年11月30日
* CentOS 7 停止维护更新日期： 2024年6月
* CentOS 8 停止维护更新日期： 2029年5月


### 解决办法

1. 备份repo文件
    ~~~
    cp /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.bak
    ~~~

1. 编辑repo文件，`vim /etc/yum.repos.d/CentOS-Base.repo`
    1. 添加如下到末尾：

        ~~~
        [centos-office]
        name=centos-office
        failovermethod=priority
        baseurl=https://vault.centos.org/6.10/os/x86_64/
        gpgcheck=1
        gpgkey=https://vault.centos.org/6.10/os/x86_64/RPM-GPG-KEY-CentOS-6
        ~~~

    1. 注释掉 mirrorlist 的设置，打开 baseurl 的设置
    1. 将 `baseurl` 中 `mirror.centos.org` 地址替换为 `vault.centos.org`

1. 修改完成，执行 `yum list` 试试
1. 


### 使用 https://vault.centos.org 报错： [Errno 14] problem making ssl connection


* 现象：

执行 yun list 报ssl错误

~~~
http://vault.centos.org/centos/6/os/x86_64/repodata/repomd.xml: [Errno 14] problem making ssl connection
~~~

* 原因

`http://vault.centos.org` 重定向到 `https://vault.centos.org`

而 `https://vault.centos.org` 只支持 TLS v1.2 及以上，

但是 CentOS 6 openssl太老， 不支持 TLS v1.2, 

* 解决办法

使用其他的支持TLSv1.2以下版本的镜像替代 `https://vault.centos.org`

* http://ftp.riken.jp/Linux/centos-vault/
* http://ftp.jaist.ac.jp/pub/Linux/CentOS-vault/
* http://ftp.iij.ad.jp/pub/linux/centos-vault/


* 参考
    * [Yum on Centos6.7 gives [Errno 14] problem making ssl connection](https://teratail.com/questions/538ut77715pp8j)


### epel repo 报错： epel-6&arch=x86_64 error was 14: problem making ssl connection


* 参考
    * [Make yum available on CentOS 6 after the end of support.](https://programwiz.org/2022/01/24/how-to-fix-yum-for-unsupported-centos6/)
    * []()

* 解决方法

更新 repo 文件

~~~
# バックアップファイル取得
sudo cp -p /etc/yum.repos.d/epel.repo{,_bak}
sudo cp -p /etc/yum.repos.d/epel-testing.repo{,_bak}

# mirrorlistコメントアウト
sudo perl -i -pe 's|^mirrorlist=|#mirrorlist=|g' /etc/yum.repos.d/epel.repo
sudo perl -i -pe 's|^mirrorlist=|#mirrorlist=|g' /etc/yum.repos.d/epel-testing.repo

# baseurl差し替え
sudo perl -i -pe 's|#baseurl=http://download.fedoraproject.org/pub/|baseurl=http://archives.fedoraproject.org/pub/archive/|g' /etc/yum.repos.d/epel.repo
sudo perl -i -pe 's|#baseurl=http://download.fedoraproject.org/|baseurl=http://archives.fedoraproject.org/|g' /etc/yum.repos.d/epel-testing.repo
~~~




























































